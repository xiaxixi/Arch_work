# Arch_work
架构大作业：火车票预定系统



### 新技术

###### 1、vue.js——前端页面

Vue 是一套用于构建用户界面的**渐进式框架**。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与现代化的工具链以及各种支持类库结合使用时，Vue 也完全能够为复杂的单页应用提供驱动。

本系统以Vue2.6为前端框架，前端主要使用了vue、vuex、vue-router、axios，另外引入了vant这个UI库和vue.js-datepicker模块（日期选择器）。

ES6——let命令；Arrow Function（箭头函数）



###### 2、axios

  一个基于Promise 用于浏览器和 nodejs 的 HTTP客户端，本质上也是对原生XHR的封装，只不过它是Promise的实现版本，符合最新的ES规范。

本系统在登陆注册前后端通讯时，使用到axios.post。



###### 3、express——后端

Express 是一个简洁而灵活的 node.js Web应用框架, 提供了一系列强大特性帮助创建各种 Web 应用，和丰富的 HTTP 工具。使用 Express 可以快速地搭建一个完整功能的网站。

本系统以express结合body-parser、cookie-parser等其他技术实现了该火车票预订系统的后端。



###### 4、sequelize

sequelize是 Node 的一个 ORM(Object-Relational Mapping) 框架，用来方便数据库mysql操作；sequelize.op用来处理复杂操作。

本系统使用sequelize连接主/从数据库、创建user表。



###### 5、Bcrypt加密

 Bcrypt是一个跨平台的文件加密工具。由它加密的文件可在所有支持的操作系统和处理器上进行转移。它的口令必须是8至56个字符，并将在内部被转化为448位的密钥。


Bcrypt加密是单向Hash加密算法，不可反向破解生成明文。破解一个Bcrypt密码的时间比较长（比MD5更长），所以时间成本太高，比MD5更安全。

本系统，在注册和登陆时对用户密码使用了Bcrypt加密，最后保存到数据库中的是加密后的密码，所以即使开发者进入数据库也无法泄露用户密码，保障了用户信息安全。




###### 6、读写分离

MySQL读写分离基本原理是让master数据库处理写操作，slave数据库处理读操作。master将写操作的变更同步到各个slave节点。

MySQL读写分离能提高系统性能的原因在于：

- 物理服务器增加，机器处理能力提升。拿硬件换性能。
- 
  主从只负责各自的读和写，极大程度缓解X锁和S锁争用。

- 
  slave可以配置myiasm引擎，提升查询性能以及节约系统开销。

- 
  master直接写是并发的，slave通过主库发送来的binlog恢复数据是异步。

- slave可以单独设置一些参数来提升其读的性能。
- 增加冗余，提高可用性。

本系统，使用两个mysql数据库：

- 
  master： IP为127.0.0.1，端口为3306 

- slave： IP为127.0.0.1，端口为3307 

  

###### 7、消息队列（MQ）

消息队列（MQ）是在消息的传输过程中保存消息的容器。当不需要立即获得结果，但是并发量又需要进行控制的时候，差不多就是需要使用消息队列的时候。

例如：用户注册了应用，系统需要发送注册邮件。当有大量用户同时注册时，异步执行发送邮件很大程度的提升系统的响应速度的同时，也避免了流量过大导致应用系统挂掉的情况。



###### 8、docker

Docker 是一个开源的**应用容器引擎**，基于Go 语言并遵从Apache2.0协议开源。

Docker 可以让开发者打包他们的应用以及依赖包到一个**轻量级**、**可移植**的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。

容器是完全使用**沙箱机制**，相互之间不会有任何接口（类似 iPhone 的 app）,更重要的是容器性能**开销极低**。

本系统使用Nginx（HTTP 和反向代理服务器）结合docker构建 Vue 应用镜像。



###### 9、loaderbalence

Load Balance负载均衡是用于解决一台机器(一个进程)无法解决所有请求而产生的一种算法。

本系统采用反向代理层->站点层的负载均衡：通过修改nginx的配置文件nginx.conf，我们可以拦截nginx接受的请求，并按设定的规则将请求分配到不同的端口去处理，以多个服务器分担请求的方式，减轻单个服务器的压力，提高服务器的工作效率，缓解若干个服务器崩溃带来的一系列问题。



#### 项目启动步骤

1、下载

2、cd train-ticket-client 

​	npm install

​	npm run serve 

3、修改 train-ticket-server/.env内容：你的数据库 用户名和密码

​	新建数据库  名称：train_ticket

4、新开终端

​	cd train-ticket-server

​	npm install

​	npm start

5、浏览器——开发者模式——Ctrl+Shift+M

#### 
